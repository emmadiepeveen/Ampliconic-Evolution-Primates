# Figure Generation

This directory contains scripts for generating the main and supplementary figures for the manuscript.

## Scripts Overview

### 1. `ampliconic_evolution_XY_plot.R`
Creates Figure 1 of the manuscript, showing ampliconic gene family evolution across X and Y chromosomes.

**Input:**
- Cluster count files:
  - `data/intermediate/cluster_counts/counts_per_species_X.tsv`
  - `data/intermediate/cluster_counts/counts_per_species_Y.tsv`
  - (Generated by `scripts/01_ampliconic_detection/clustering_ampliconic_X.ipynb` and `clustering_ampliconic_Y.ipynb`)
- Gene details with cluster information:
  - `data/intermediate/clusters/all_families_gene_details_with_clusters_X.tsv`
  - `data/intermediate/clusters/all_families_gene_details_with_clusters_Y.tsv`
  - (Generated by clustering scripts)
- Amplicon summary file:
  - `data/reference/Amplicon_summary_count_expression_genefamily.xlsx`
- PAML site test results:
  - `data/intermediate/paml/codeml_site_tests_median_omega_X.csv`
  - `data/intermediate/paml/codeml_site_tests_median_omega_Y.csv`
  - (Generated by `scripts/02_selection/PAML_site_tests.ipynb`)

**Output:**
- Figure 1 (all panels)
  - Tile plots showing gene family distribution across species
  - Bubble plots showing relationship between copy number, selection, and expression

### 2. `XY_gene_family_synteny.R`
Creates Figure 2 of the manuscript, showing synteny patterns of ampliconic gene families.

**Input:**
- Gene details with cluster information:
  - `data/intermediate/clusters/all_families_gene_details_with_clusters_X.tsv`
  - `data/intermediate/clusters/all_families_gene_details_with_clusters_Y.tsv`
- Sequence Class files from Makova et al., 2024:
  - `data/raw/palindromes/` 
- Palindrome annotation files from Makova et al., 2024:
  - `data/raw/palindromes/`

**Output:**
- Figure 2 (synteny visualization)
- Supplementary Figure 3 

### 3. `supplementaryfigures.R`
Generates supplementary figures 1, 4, 5 and 6. 

**Input:**
- Amplicon summary file:
  - `data/reference/Amplicon_summary_count_expression_genefamily.xlsx`
- Gene details with cluster information:
  - `data/intermediate/clusters/all_families_gene_details_with_clusters_X.tsv`
  - `data/intermediate/clusters/all_families_gene_details_with_clusters_Y.tsv`
- Sequence annotation files from Makova et al., 2024:
  - `data/raw/annotations/`
- Palindrome annotation files from Makova et al., 2024:
  - `data/raw/palindromes/`

**Output:**
- Supplementary Figure 1: Copy number and expression relationship
- Supplementary Figure 4: Observed versus expected distance to palindrome. Uses intermediate files generated during the creation of Supplementary Figures 5 and 6
- Supplementary Figure 5 + 6: Gene family genomic location X and Y 


